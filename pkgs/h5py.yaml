extends: [setuptools_package]

dependencies:
  build: [hdf5, mpi4py, mpi, numpy, cython, pkgconfig, six]
  run: [numpy, mpi4py, pkgconfig, cython]

sources:
- key: tar.gz:n7vnqlymiaam6ogvh6oagb4a3an7uara
  url: https://files.pythonhosted.org/packages/69/f4/3172bb63d3c57e24aec42bb93fcf1da4102752701ab5ad10b3ded00d0c5b/h5py-3.8.0.tar.gz

build_stages:
- name: install
  after: setup_dirs
  mode: replace
  handler: bash
  bash: |
       HDF5_VERSION=1.14.0 HDF5_MPI="ON"  \
       CC=${MPICC} CXX=${MPICXX} ${PYTHON} -c 'import setuptools; __file__="setup.py"; exec(open(__file__).read())' \
       ${SETUPTOOLS_PACKAGE_EXTRA_OPTIONS} \
       install \
       --prefix=. --root=${ARTIFACT} \
       --single-version-externally-managed

